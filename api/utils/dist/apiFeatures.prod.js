"use strict";function ownKeys(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,i)}return r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(r,!0).forEach(function(e){_defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ownKeys(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var APIFeatures=function(){function r(e,t){_classCallCheck(this,r),this.query=e,this.queryString=t}return _createClass(r,[{key:"filter",value:function(){var t=_objectSpread({},this.queryString);["page","sort","limit","fields"].forEach(function(e){return delete t[e]});var e=JSON.stringify(t);return e=e.replace(/\b(gte|gt|lte|lt)\b/g,function(e){return"$".concat(e)}),this.query=this.query.find(JSON.parse(e)),this}},{key:"sort",value:function(){if(this.queryString.sort){var e=this.queryString.sort.split(",").join(" ");this.query=this.query.sort(e)}else this.query=this.query.sort("-createdAt");return this}},{key:"limitFields",value:function(){if(this.queryString.fields){var e=this.queryString.fields.split(",").join(" ");this.query=this.query.select(e)}else this.query=this.query.select("-__v");return this}},{key:"paginate",value:function(){var e=1*this.queryString.page||1,t=1*this.queryString.limit||100,r=(e-1)*t;return this.query=this.query.skip(r).limit(t),this}}]),r}();module.exports=APIFeatures;