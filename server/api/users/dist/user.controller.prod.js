"use strict";var _require=require("./user.service"),create=_require.create,getUserByUserEmail=_require.getUserByUserEmail,_getUserByUserId=_require.getUserByUserId,_getUsers=_require.getUsers,updateUser=_require.updateUser,_deleteUser=_require.deleteUser,_require2=require("bcrypt"),hashSync=_require2.hashSync,genSaltSync=_require2.genSaltSync,compareSync=_require2.compareSync,_require3=require("jsonwebtoken"),sign=_require3.sign;module.exports={createUser:function(e,r){var s=e.body,o=genSaltSync(10);s.password=hashSync(s.password,o),create(s,function(e,s){return e?(console.log(e),r.status(500).json({success:0,message:"Database connection errror"})):r.status(200).json({success:1,data:s})})},login:function(e,n){var c=e.body;getUserByUserEmail(c.email,function(e,s){if(e&&console.log(e),!s)return n.json({success:0,data:"Invalid email or password"});var r=compareSync(c.password,s.password);if(r){s.password=void 0;var o=sign({result:s},"qwe1234",{expiresIn:"1h"});return console.log(r),o.secure=!0,n.cookie("token",r.token,o),n.json({success:1,message:"login successfully",token:o})}return n.json({success:0,data:"Invalid email or password"})})},getUserByUserId:function(e,r){var s=e.params.id;_getUserByUserId(s,function(e,s){if(!e)return s?(s.password=void 0,r.json({success:1,data:s})):r.json({success:0,message:"Record not Found"});console.log(e)})},getUsers:function(e,r){_getUsers(function(e,s){if(!e)return r.json({success:1,data:s});console.log(e)})},updateUsers:function(e,r){var s=e.body,o=genSaltSync(10);s.password=hashSync(s.password,o),updateUser(s,function(e,s){if(!e)return r.json({success:1,message:"updated successfully"});console.log(e)})},deleteUser:function(e,r){var s=e.body;_deleteUser(s,function(e,s){if(!e)return s?r.json({success:1,message:"user deleted successfully"}):r.json({success:0,message:"Record Not Found"});console.log(e)})}};